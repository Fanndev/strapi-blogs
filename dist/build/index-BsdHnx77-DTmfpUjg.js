function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["index-BE_75e6q-CNH0T50v.js","strapi-B-LHh8jx.js","strapi-COJtagOC.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{X as g,ii as q,ij as k,ik as Ge,d as Y,r as y,cv as _e,il as Ne,ah as O,f as v,im as d,j as e,P as A,R as He,p as je,B as Q,T as ee,a6 as We,io as Ke,b1 as Se,a7 as ke,ip as Je,iq as P,ir as Xe,is as Ze,it as Ye,iu as es,iv as ss,iw as E,ix as ts,L as $,aw as Le,iy as as,aB as W,bQ as is,ct as Re,ax as os,iz as ns,f5 as rs,an as ls,iA as ds,iB as cs,G as X,iC as us,aA as gs,iD as fs,iE as ps,F as z,as as hs,bM as ms,iF as xs,by as K,iG as js,iH as bs,iI as ys,iJ as vs,iK as Cs,d3 as Fs,n as L,am as Z,a_ as be,a$ as Ms,iL as Ss,iM as ye,iN as ks,iO as Ls,s as Rs,al as As,aN as ws,iP as Es,au as ve,aC as Ts,av as Ds,aE as b,f1 as Bs,iQ as Is,bz as Ps,a9 as $s,aa as qs,k as Ce,iR as Os,u as Qs,D as zs,g as Us,i as Vs,iS as J,iT as Gs,a2 as _s}from"./strapi-B-LHh8jx.js";const Ns=(s,{pathname:a,query:i})=>{let o=[{id:null,label:{id:d("plugin.name"),defaultMessage:"Media Library"},href:s?E(a,i):void 0}];return s?.parent?.parent&&o.push([]),s?.parent&&o.push({id:s.parent.id,label:s.parent.name,href:E(a,i,{folder:s.parent.id,folderPath:s.parent.path})}),s&&o.push({id:s.id,label:s.name}),o},Hs=s=>{const{id:a}=vs();return e.jsx(Q,{position:"relative",zIndex:2,children:e.jsx(Le,{"aria-labelledby":`${a}-title`,...s})})},Ae=({selected:s,onSuccess:a})=>{const{formatMessage:i}=v(),{remove:o}=Es(),n=async()=>{await o(s),a()};return e.jsxs(ve.Root,{children:[e.jsx(ve.Trigger,{children:e.jsx(L,{variant:"danger-light",size:"S",startIcon:e.jsx(Ts,{}),children:i({id:"global.delete",defaultMessage:"Delete"})})}),e.jsx(Ds,{onConfirm:n})]})};Ae.propTypes={selected:g.arrayOf(q,k).isRequired,onSuccess:g.func.isRequired};const Ws=()=>{const{formatMessage:s}=v(),{toggleNotification:a}=Qs(),i=zs(),{post:o}=Us(),r=Vs(({destinationFolderId:h,filesAndFolders:f})=>{const c=f.reduce((u,M)=>{const{id:l,type:S}=M,m=S==="asset"?"fileIds":"folderIds";return u[m]||(u[m]=[]),u[m].push(l),u},{});return o("/upload/actions/bulk-move",{...c,destinationFolderId:h})},{onSuccess(h){const{data:{data:f}}=h;f?.files?.length>0&&(i.refetchQueries([J,"assets"],{active:!0}),i.refetchQueries([J,"asset-count"],{active:!0})),i.refetchQueries([J,"folders"],{active:!0}),a({type:"success",message:s({id:d("modal.move.success-label"),defaultMessage:"Elements have been moved successfully."})})}});return{...r,move:(h,f)=>r.mutateAsync({destinationFolderId:h,filesAndFolders:f})}},se=({onClose:s,selected:a,currentFolder:i})=>{const{formatMessage:o}=v(),{data:n,isLoading:r}=Is(),{move:p}=Ws();if(!n)return null;const h=async(c,{setErrors:u})=>{try{await p(c.destination.value,a),s()}catch(M){const S=Gs(M).errors.reduce((m,T)=>(m[T.values?.path?.length||"destination"]=T.defaultMessage,m),{});_s(S)||u(S)}};if(r)return e.jsx(b.Content,{children:e.jsx(b.Body,{children:e.jsx(z,{justifyContent:"center",paddingTop:4,paddingBottom:4,children:e.jsx(Ps,{children:o({id:d("content.isLoading"),defaultMessage:"Content is loading."})})})})});const f={destination:{value:i?.id||"",label:i?.name||n[0].label}};return e.jsx(b.Content,{children:e.jsx($s,{validateOnChange:!1,onSubmit:h,initialValues:f,children:({values:c,errors:u,setFieldValue:M})=>e.jsxs(qs,{noValidate:!0,children:[e.jsx(b.Header,{children:e.jsx(b.Title,{children:o({id:d("modal.folder.move.title"),defaultMessage:"Move elements to"})})}),e.jsx(b.Body,{children:e.jsx(X.Root,{gap:4,children:e.jsx(X.Item,{xs:12,col:12,direction:"column",alignItems:"stretch",children:e.jsxs(Ce.Root,{id:"folder-destination",children:[e.jsx(Ce.Label,{children:o({id:d("form.input.label.folder-location"),defaultMessage:"Location"})}),e.jsx(Os,{options:n,onChange:l=>{M("destination",l)},defaultValue:c.destination,name:"destination",menuPortalTarget:document.querySelector("body"),inputId:"folder-destination",error:u?.destination,ariaErrorMessage:"destination-error"}),u.destination&&e.jsx(ee,{variant:"pi",tag:"p",textColor:"danger600",children:u.destination})]})})})}),e.jsxs(b.Footer,{children:[e.jsx(b.Close,{children:e.jsx(L,{variant:"tertiary",name:"cancel",children:o({id:"cancel",defaultMessage:"Cancel"})})}),e.jsx(L,{type:"submit",loading:r,children:o({id:"modal.folder.move.submit",defaultMessage:"Move"})})]})]})})})};se.defaultProps={currentFolder:void 0,selected:[]};se.propTypes={onClose:g.func.isRequired,currentFolder:k,selected:g.arrayOf(k,q)};const te=({selected:s,onSuccess:a,currentFolder:i})=>{const{formatMessage:o}=v(),[n,r]=y.useState(!1),p=()=>{r(!1),a()};return e.jsxs(b.Root,{open:n,onOpenChange:r,children:[e.jsx(b.Trigger,{children:e.jsx(L,{variant:"secondary",size:"S",startIcon:e.jsx(Bs,{}),children:o({id:"global.move",defaultMessage:"Move"})})}),e.jsx(se,{currentFolder:i,onClose:p,selected:s})]})};te.defaultProps={currentFolder:void 0,selected:[]};te.propTypes={onSuccess:g.func.isRequired,currentFolder:k,selected:g.arrayOf(q,k)};const ae=({selected:s,onSuccess:a,currentFolder:i})=>{const{formatMessage:o}=v();return e.jsxs(z,{gap:2,paddingBottom:5,children:[e.jsx(ee,{variant:"epsilon",textColor:"neutral600",children:o({id:d("list.assets.selected"),defaultMessage:"{numberFolders, plural, one {1 folder} other {# folders}} - {numberAssets, plural, one {1 asset} other {# assets}} selected"},{numberFolders:s.filter(({type:n})=>n==="folder").length,numberAssets:s.filter(({type:n})=>n==="asset").length})}),e.jsx(Ae,{selected:s,onSuccess:a}),e.jsx(te,{currentFolder:i,selected:s,onSuccess:a})]})};ae.defaultProps={currentFolder:void 0,selected:[]};ae.propTypes={onSuccess:g.func.isRequired,currentFolder:k,selected:g.arrayOf(q,k)};const Ks=({isFiltering:s,canCreate:a,canRead:i})=>s?{id:"list.assets-empty.title-withSearch",defaultMessage:"There are no elements with the applied filters"}:i?a?{id:"list.assets.empty-upload",defaultMessage:"Upload your first assets..."}:{id:"list.assets.empty",defaultMessage:"Media Library is empty"}:{id:"header.actions.no-permissions",defaultMessage:"No permissions to view"},we=({canCreate:s,isFiltering:a,canRead:i,onActionClick:o})=>{const{formatMessage:n}=v(),r=Ks({isFiltering:a,canCreate:s,canRead:i});return e.jsx(Cs,{icon:i?void 0:Fs,action:s&&!a&&e.jsx(L,{variant:"secondary",startIcon:e.jsx(Z,{}),onClick:o,children:n({id:d("header.actions.add-assets"),defaultMessage:"Add new assets"})}),content:n({...r,id:d(r.id)})})};we.propTypes={canCreate:g.bool.isRequired,canRead:g.bool.isRequired,isFiltering:g.bool.isRequired,onActionClick:g.func.isRequired};const Js=()=>{const[s,a]=y.useState(!1),{formatMessage:i}=v(),{trackUsage:o}=ke(),[{query:n},r]=O(),p=n?.filters?.$and||[],h=c=>{r({filters:{$and:c},page:1})},f=c=>{o("didFilterMediaLibraryElements",{location:"content-manager",filter:Object.keys(c[c.length-1])[0]}),r({filters:{$and:c},page:1})};return e.jsxs(be.Root,{open:s,onOpenChange:a,children:[e.jsx(be.Trigger,{children:e.jsx(L,{variant:"tertiary",startIcon:e.jsx(Ms,{}),size:"S",children:i({id:"app.utils.filters",defaultMessage:"Filters"})})}),e.jsx(Ss,{displayedFilters:ye,filters:p,onSubmit:f,onToggle:a}),e.jsx(ks,{appliedFilters:p,filtersSchema:ye,onRemoveFilter:h})]})},ie=({breadcrumbs:s,canCreate:a,folder:i,onToggleEditFolderDialog:o,onToggleUploadAssetDialog:n})=>{const{formatMessage:r}=v(),{pathname:p}=Se(),[{query:h}]=O(),f={...h,folder:i?.parent?.id??void 0,folderPath:i?.parent?.path??void 0};return e.jsx($.Header,{title:r({id:d("plugin.name"),defaultMessage:"Media Library"}),subtitle:s&&i&&e.jsx(Ls,{tag:"nav",label:r({id:d("header.breadcrumbs.nav.label"),defaultMessage:"Folders navigation"}),breadcrumbs:s,currentFolderId:i?.id}),navigationAction:i&&e.jsx(Rs,{tag:As,startIcon:e.jsx(ws,{}),to:`${p}?${Re.stringify(f,{encode:!1})}`,children:r({id:d("header.actions.folder-level-up"),defaultMessage:"Back"})}),primaryAction:a&&e.jsxs(z,{gap:2,children:[e.jsx(L,{startIcon:e.jsx(Z,{}),variant:"secondary",onClick:o,children:r({id:d("header.actions.add-folder"),defaultMessage:"Add new folder"})}),e.jsx(L,{startIcon:e.jsx(Z,{}),onClick:n,children:r({id:d("header.actions.add-assets"),defaultMessage:"Add new assets"})})]})})};ie.defaultProps={breadcrumbs:!1,folder:null};ie.propTypes={breadcrumbs:g.oneOfType([Ge,g.bool]),canCreate:g.bool.isRequired,folder:k,onToggleEditFolderDialog:g.func.isRequired,onToggleUploadAssetDialog:g.func.isRequired};const Xs=Y(Q)`
  height: 3.2rem;
  display: flex;
  align-items: center;
`,Fe=Y(ee)`
  max-width: 100%;
`,Me=Y(Q)`
  svg {
    path {
      fill: ${({theme:s})=>s.colors.neutral500};
    }
  }
`,Zs=()=>{const s=We(),{canRead:a,canCreate:i,canUpdate:o,canCopyLink:n,canDownload:r,canConfigureView:p,isLoading:h}=Ke(),f=y.useRef(),{formatMessage:c}=v(),{pathname:u}=Se(),{trackUsage:M}=ke(),[{query:l},S]=O(),m=!!(l._q||l.filters),[T,Ee]=Je(Xe.view,P.GRID),R=T===P.GRID,{data:C,isLoading:Te,errors:De}=Ze({skipWhen:!a,query:l}),{data:Be,isLoading:Ie,errors:Pe}=Ye({enabled:a&&C?.pagination?.page===1&&!es(l),query:l}),{data:U,isLoading:oe,error:$e}=ss(l?.folder,{enabled:a&&!!l?.folder});$e?.response?.status===404&&s(u);const D=Be?.map(t=>({...t,type:"folder",folderURL:E(u,l,t.id),isSelectable:o}))??[],x=D?.length||0,B=C?.results?.map(t=>({...t,type:"asset",isSelectable:o}))||[],j=B?.length??0,qe=C?.pagination?.total,Oe=oe||Ie||h||Te,[ne,Qe]=y.useState(!1),[re,le]=y.useState(!1),[V,G]=y.useState(void 0),[_,de]=y.useState(void 0),[F,{selectOne:I,selectAll:ce}]=ts(["type","id"],[]),ue=F?.length>0&&F?.length!==j+x,N=()=>Qe(t=>!t),ge=({created:t=!1}={})=>{t&&l?.page!=="1"&&S({...l,page:1}),le(w=>!w)},fe=(t,w)=>{t&&M("didSelectAllMediaLibraryElements"),ce(w)},pe=t=>{M("didSortMediaLibraryElements",{location:"upload",sort:t}),S({sort:t})},he=t=>{de(t),le(!0)},ze=t=>{de(null),ge(t),f.current&&f.current.focus()},me=t=>{t===j&&C.pagination.page===C.pagination.pageCount&&C.pagination.page>1&&S({...l,page:C.pagination.page-1})},Ue=()=>{ce(),me(F.length)};return Oe?e.jsx(A.Loading,{}):De||Pe?e.jsx(A.Error,{}):e.jsxs($.Root,{children:[e.jsxs(A.Main,{children:[e.jsx(ie,{breadcrumbs:!oe&&Ns(U,{pathname:u,query:l}),canCreate:i,onToggleEditFolderDialog:ge,onToggleUploadAssetDialog:N,folder:U}),e.jsx($.Action,{startActions:e.jsxs(e.Fragment,{children:[o&&R&&(j>0||x>0)&&e.jsx(Xs,{paddingLeft:2,paddingRight:2,background:"neutral0",hasRadius:!0,borderColor:"neutral200",children:e.jsx(Le,{"aria-label":c({id:d("bulk.select.label"),defaultMessage:"Select all folders & assets"}),checked:ue?"indeterminate":(j>0||x>0)&&F.length===j+x,onCheckedChange:t=>fe(t,[...B,...D])})}),a&&R&&e.jsx(as,{value:l?.sort,onChangeSort:pe}),a&&e.jsx(Js,{})]}),endActions:e.jsxs(e.Fragment,{children:[p?e.jsx(Me,{paddingTop:1,paddingBottom:1,children:e.jsx(W,{tag:is,to:{pathname:`${u}/configuration`,search:Re.stringify(l,{encode:!1})},label:c({id:"app.links.configure-view",defaultMessage:"Configure the view"}),children:e.jsx(os,{})})}):null,e.jsx(Me,{paddingTop:1,paddingBottom:1,children:e.jsx(W,{label:c(R?{id:d("view-switch.list"),defaultMessage:"List View"}:{id:d("view-switch.grid"),defaultMessage:"Grid View"}),onClick:()=>Ee(R?P.LIST:P.GRID),children:R?e.jsx(ns,{}):e.jsx(rs,{})})}),e.jsx(ls,{label:c({id:d("search.label"),defaultMessage:"Search for an asset"}),trackedEvent:"didSearchMediaLibraryElements",trackedEventDetails:{location:"upload"}})]})}),e.jsxs($.Content,{children:[F.length>0&&e.jsx(ae,{currentFolder:U,selected:F,onSuccess:Ue}),x===0&&j===0&&e.jsx(we,{canCreate:i,canRead:a,isFiltering:m,onActionClick:N}),a&&!R&&(j>0||x>0)&&e.jsx(ds,{assetCount:j,folderCount:x,indeterminate:ue,onChangeSort:pe,onChangeFolder:(t,w)=>s(E(u,l,{folder:t,folderPath:w})),onEditAsset:G,onEditFolder:he,onSelectOne:I,onSelectAll:fe,rows:[...D,...B],selected:F,shouldDisableBulkSelect:!o,sortQuery:l?.sort??""}),a&&R&&e.jsxs(e.Fragment,{children:[x>0&&e.jsx(cs,{title:(m&&j>0||!m)&&c({id:d("list.folders.title"),defaultMessage:"Folders ({count})"},{count:x})||"",children:D.map(t=>{const Ve=!!F.filter(({type:H})=>H==="folder").find(H=>H.id===t.id),xe=E(u,l,{folder:t?.id,folderPath:t?.path});return e.jsx(X.Item,{col:3,direction:"column",alignItems:"stretch",children:e.jsx(us,{ref:_&&t.id===_.id?f:void 0,ariaLabel:t.name,id:`folder-${t.id}`,to:xe,startAction:I&&t.isSelectable?e.jsx(Hs,{"data-testid":`folder-checkbox-${t.id}`,checked:Ve,onCheckedChange:()=>I(t)}):null,cardActions:e.jsx(W,{"aria-label":c({id:d("list.folder.edit"),defaultMessage:"Edit folder"}),onClick:()=>he(t),children:e.jsx(gs,{})}),children:e.jsx(fs,{children:e.jsx(ps,{to:xe,children:e.jsxs(z,{tag:"h2",direction:"column",alignItems:"start",maxWidth:"100%",children:[e.jsxs(Fe,{fontWeight:"semiBold",textColor:"neutral800",ellipsis:!0,children:[t.name,e.jsx(hs,{children:":"})]}),e.jsx(Fe,{tag:"span",textColor:"neutral600",variant:"pi",ellipsis:!0,children:c({id:d("list.folder.subtitle"),defaultMessage:"{folderCount, plural, =0 {# folder} one {# folder} other {# folders}}, {filesCount, plural, =0 {# asset} one {# asset} other {# assets}}"},{folderCount:t.children.count,filesCount:t.files.count})})]})})})})},`folder-${t.id}`)})}),j>0&&x>0&&e.jsx(Q,{paddingTop:6,paddingBottom:4,children:e.jsx(ms,{})}),j>0&&e.jsx(xs,{assets:B,onEditAsset:G,onSelectAsset:I,selectedAssets:F.filter(({type:t})=>t==="asset"),title:(!m||m&&x>0)&&C?.pagination?.page===1&&c({id:d("list.assets.title"),defaultMessage:"Assets ({count})"},{count:qe})||""})]}),e.jsxs(K.Root,{...C.pagination,children:[e.jsx(K.PageSize,{}),e.jsx(K.Links,{})]})]})]}),ne&&e.jsx(js,{open:ne,onClose:N,trackedLocation:"upload",folderId:l?.folder}),re&&e.jsx(bs,{open:re,onClose:ze,folder:_,parentFolderId:l?.folder,location:"upload"}),V&&e.jsx(ys,{onClose:t=>{t===null&&me(1),G(void 0)},open:!!V,asset:V,canUpdate:o,canCopyLink:n,canDownload:r,trackedLocation:"upload"})]})},Ys=y.lazy(()=>_e(()=>import("./index-BE_75e6q-CNH0T50v.js"),__vite__mapDeps([0,1,2]))),st=()=>{const{config:{isLoading:s,isError:a,data:i}}=Ne(),[{rawQuery:o},n]=O(),{formatMessage:r}=v(),p=r({id:d("plugin.name"),defaultMessage:"Media Library"});return y.useEffect(()=>{s||a||o||n({sort:i.sort,page:1,pageSize:i.pageSize})},[s,a,i,o,n]),s?e.jsxs(e.Fragment,{children:[e.jsx(A.Title,{children:p}),e.jsx(A.Loading,{})]}):e.jsx(A.Main,{children:o?e.jsx(y.Suspense,{fallback:e.jsx(A.Loading,{}),children:e.jsxs(He,{children:[e.jsx(je,{index:!0,element:e.jsx(Zs,{})}),e.jsx(je,{path:"configuration",element:e.jsx(Ys,{config:i})})]})}):null})};export{st as default};
